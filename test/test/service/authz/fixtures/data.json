{

    "env_default": {
        "env": {
            "now": "2020-02-02T12:34:56Z"
        }
    },

    "op_orgmgmt_create_invitation": {
        "orgmgmt": {
            "op": {
                "id": "CreateInvitation",
                "organization": {"id": "PARTY"}
            }
        }
    },

    "op_capi_create_payment_resource": {
        "capi": {
            "op": {
                "id": "CreatePaymentResource",
                "party": {"id": "PARTY"}
            }
        }
    },

    "op_capi_create_invoice": {
        "capi": {
            "op": {
                "id": "CreateInvoice",
                "invoice": {"id": "INVOICE"},
                "shop": {"id": "SHOP"},
                "party": {"id": "PARTY"}
            }
        }
    },

    "op_capi_get_invoice": {
        "capi": {
            "op": {
                "id": "GetInvoiceByID",
                "invoice": { "id": "INVOICE" },
                "shop": { "id": "SHOP" },
                "party": { "id": "PARTY" }
            }
        }
    },

    "op_capi_create_refund": {
        "capi": {
            "op": {
                "id": "CreateRefund",
                "invoice": {"id": "INVOICE"},
                "payment": {"id": "PAYMENT"},
                "shop": {"id": "SHOP"},
                "party": {"id": "PARTY"}
            }
        }
    },


    "op_capi_get_invoice_2": {
        "capi": {
            "op": {
                "id": "GetInvoiceByID",
                "invoice": { "id": "INVOICE_2" },
                "shop": { "id": "SHOP" },
                "party": { "id": "PARTY" }
            }
        }
    },

    "op_capi_get_invoice_payment_methods": {
        "capi": {
            "op": {
                "id": "GetInvoicePaymentMethods",
                "invoice": { "id": "INVOICE" },
                "shop": { "id": "SHOP" },
                "party": { "id": "PARTY" }
            }
        }
    },

    "op_capi_get_invoice_events": {
        "capi": {
            "op": {
                "id": "GetInvoiceEvents",
                "invoice": { "id": "INVOICE" },
                "shop": { "id": "SHOP" },
                "party": { "id": "PARTY" }
            }
        }
    },

    "op_capi_create_payment": {
        "capi": {
            "op": {
                "id": "CreatePayment",
                "invoice": { "id": "INVOICE" },
                "shop": { "id": "SHOP" },
                "party": { "id": "PARTY" }
            }
        }
    },

    "op_capi_get_payments": {
        "capi": {
            "op": {
                "id": "GetPayments",
                "invoice": { "id": "INVOICE" },
                "shop": { "id": "SHOP" },
                "party": { "id": "PARTY" }
            }
        }
    },

    "op_capi_get_payment_by_id": {
        "capi": {
            "op": {
                "id": "GetPaymentByID",
                "invoice": { "id": "INVOICE" },
                "shop": { "id": "SHOP" },
                "party": { "id": "PARTY" }
            }
        }
    },

    "session_token_valid": {
        "auth": {
            "method": "SessionToken",
            "expiration": "2021-01-01T00:00:00Z"
        }
    },

    "invoice_access_token_valid": {
        "auth": {
            "method": "InvoiceAccessToken",
            "expiration": "2021-01-01T00:00:00Z",
            "scope": [
                {
                    "invoice": { "id": "INVOICE" },
                    "party": { "id": "PARTY" }
                }
            ]
        }
    },

    "invoice_access_token_valid_party_2": {
        "auth": {
            "method": "InvoiceAccessToken",
            "expiration": "2021-01-01T00:00:00Z",
            "scope": [
                {
                    "invoice": { "id": "INVOICE" },
                    "party": { "id": "PARTY_2" }
                }
            ]
        }
    },

    "invoice_access_token_expired": {
        "auth": {
            "method": "InvoiceAccessToken",
            "expiration": "2020-02-02T00:00:00Z",
            "scope": [
                {
                    "invoice": { "id": "INVOICE" }
                }
            ]
        }
    },

    "op_shortener_shorten_url": {
        "shortener": {
            "op": {
                "id": "ShortenUrl"
            }
        }
    },

    "op_shortener_get_shorten_url": {
        "shortener": {
            "op": {
                "id": "GetShortenedUrl",
                "shortened_url": {
                    "owner": { "id": "USER" }
                }
            }
        }
    },

    "op_shortener_delete_shorten_url": {
        "shortener": {
            "op": {
                "id": "DeleteShortenedUrl",
                "shortened_url": {
                    "owner": { "id": "USER" }
                }
            }
        }
    },

    "op_binapi_lookup_card_info": {
        "binapi": {
            "op": {
                "id": "LookupCardInfo",
                "party": {
                    "id": "PARTY_2"
                }
            }
        }
    },

    "op_anapi": {
        "anapi": {
            "op": {
                "id": "SearchInvoices",
                "party": { "id": "PARTY"},
                "shops": [
                    { "id": "SHOP" }
                ]
            }
        }
    },

    "op_anapi_no_shops": {
        "anapi": {
            "op": {
                "id": "SearchInvoices",
                "party": { "id": "PARTY"},
                "shops": []
            }
        }
    },

    "op_anapi_several_shops": {
        "anapi": {
            "op": {
                "id": "SearchInvoices",
                "party": { "id": "PARTY"},
                "shops": [
                    { "id": "SHOP" },
                    { "id": "SHOP2" },
                    { "id": "SHOP3" }
                ]
            }
        }
    },

    "op_anapi_reports": {
        "anapi": {
            "op": {
                "id": "SearchReports",
                "party": { "id": "PARTY"},
                "shops": [
                    { "id": "SHOP" }
                ]
            }
        }
    },

    "op_anapi_restrictions": {
        "anapi": {
            "op": {
                "shops": [
                    {
                        "id": "SHOP"
                    }
                ]
            }
        }
    },

    "op_anapi_restrictions_several_shops": {
        "anapi": {
            "op": {
                "shops": [
                    {
                        "id": "SHOP"
                    },
                    {
                        "id": "SHOP2"
                    }
                ]
            }
        }
    },

    "user_default_other_role": {
        "user": {
            "id": "USER",
            "orgs": [
                {
                    "id": "PARTY",
                    "owner": { "id": "OWNER" },
                    "roles": [
                        {
                            "id": "OtherRole",
                            "scope": {
                                "shop": {
                                    "id": "SHOP"
                                }
                            }
                        }
                    ]
                }
            ]
        }
    },

    "user_default": {
        "user": {
            "id": "USER",
            "orgs": [
                {
                    "id": "PARTY",
                    "owner": { "id": "OWNER" },
                    "roles": [
                        {
                            "id": "Manager",
                            "scope": {
                                "shop": {
                                    "id": "SHOP"
                                }
                            }
                        }
                    ]
                }
            ]
        }
    },

    "user_several_roles": {
        "user": {
            "id": "USER",
            "orgs": [
                {
                    "id": "PARTY",
                    "owner": { "id": "OWNER" },
                    "roles": [
                        {
                            "id": "Manager",
                            "scope": {
                                "shop": {
                                    "id": "SHOP"
                                }
                            }
                        },
                        {
                            "id": "Manager",
                            "scope": {
                                "shop": {
                                    "id": "SHOP2"
                                }
                            }
                        },
                        {
                            "id": "OtherRole",
                            "scope": {
                                "shop": {
                                    "id": "SHOP3"
                                }
                            }
                        }
                    ]
                }
            ]
        }
    },
    
    "user_with_role_without_scope": {
        "user": {
            "id": "USER",
            "orgs": [
                {
                    "id": "PARTY",
                    "owner": { "id": "OWNER" },
                    "roles": [
                        {
                            "id": "Manager"
                        }
                    ]
                }
            ]
        }
    },

    "user_no_roles": {
        "user": {
            "id": "USER",
            "orgs": [
                {
                    "id": "PARTY",
                    "owner": { "id": "OWNER" },
                    "roles": []
                }
            ]
        }
    },

    "user_owner": {
        "user": {
            "id": "OWNER",
            "orgs": [
                {
                    "id": "PARTY",
                    "owner": { "id": "OWNER" },
                    "roles": []
                }
            ]
        }
    },

    "requester_default": {
        "requester": {
            "ip": "95.217.228.176"
        }
    },

    "requester_local": {
        "requester": {
            "ip": "10.1.17.141"
        }
    },

    "requester_local_ipv6": {
        "requester": {
            "ip": "fd12:3456:789a:1::42"
        }
    }

}
